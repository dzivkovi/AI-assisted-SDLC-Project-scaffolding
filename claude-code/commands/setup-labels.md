# Setup GitHub Labels

## Purpose

Analyze project specifications and generate appropriate GitHub labels by reading specs naturally with LLM understanding.

## Workflow

1. Read `specs/StoryBreakdown.md` to understand epic structure
2. Generate `.github/LABELS.md` with proposed labels
3. Show summary to user
4. Ask for approval: "Should I create these labels in GitHub?"
5. If yes, execute `gh label create` commands
6. Show delta report (what was added vs already existed)

## How It Works

### Step 1: Read Specs Naturally

Read `specs/StoryBreakdown.md` and understand:
- Epic numbers and titles (e.g., "## Epic 0: Environment Setup")
- Project domain from context (air-gapped, web, mobile, etc.)
- Priority conventions

**No regex, no parallel agents - just LLM natural reading.**

### Step 2: Generate Label Proposal

Create `.github/LABELS.md` with:

**Standard Labels (Always):**
- `story` (0E8A16 green) - User story or feature implementation
- `epic` (5319E7 purple) - Large feature spanning multiple stories
- `infra` (FBCA04 yellow) - Infrastructure, build, CI/CD, refactoring

**Priority Labels (Always):**
- `P0` (B60205 red) - Critical priority, blocks other work
- `P1` (D93F0B orange) - High priority
- `P2` (FBCA04 yellow) - Medium priority

**Epic Tracking (From Specs):**
- `epic-0`, `epic-1`, `epic-2`, etc. (C5DEF5 light blue)
- Extract from "## Epic N: Title" patterns
- Use actual epic titles in descriptions

**Domain-Specific (Inferred):**
- Examples: `dependencies`, `air-gapped`, `security`
- Infer from PRD.md and project context
- Keep to 2-4 labels maximum

**Target:** 10-20 total labels

### Step 3: LABELS.md File Structure

**IMPORTANT:** This is a template showing the output format. Replace placeholders with actual values from the project's StoryBreakdown.md.

```markdown
# GitHub Labels

> Generated by /setup-labels on YYYY-MM-DD
> Source: specs/StoryBreakdown.md

## Summary

**Total labels proposed:** [N]

**Categories:**
- Standard: 3 (story, epic, infra)
- Priorities: 3 (P0, P1, P2)
- Epic tracking: [N] (epic-0 to epic-[N-1])
- Domain-specific: [N] ([inferred from project context])

---

## Label Definitions

### Standard Issue Types

| Label | Color | Description | Command |
|-------|-------|-------------|---------|
| story | 0E8A16 | User story or feature implementation | `gh label create "story" --description "User story or feature implementation" --color "0E8A16"` |
| epic | 5319E7 | Large feature spanning multiple stories | `gh label create "epic" --description "Large feature spanning multiple stories" --color "5319E7"` |
| infra | FBCA04 | Infrastructure, build, CI/CD, refactoring | `gh label create "infra" --description "Infrastructure, build, CI/CD, refactoring" --color "FBCA04"` |

### Priorities

| Label | Color | Description | Command |
|-------|-------|-------------|---------|
| P0 | B60205 | Critical priority - blocks other work | `gh label create "P0" --description "Critical priority - blocks other work" --color "B60205"` |
| P1 | D93F0B | High priority | `gh label create "P1" --description "High priority" --color "D93F0B"` |
| P2 | FBCA04 | Medium priority | `gh label create "P2" --description "Medium priority" --color "FBCA04"` |

### Epic Tracking

**Extract epic titles from specs/StoryBreakdown.md - use actual titles from "## Epic N: Title" patterns**

| Label | Color | Description | Command |
|-------|-------|-------------|---------|
| epic-0 | C5DEF5 | Epic 0: [Title from StoryBreakdown.md] | `gh label create "epic-0" --description "Epic 0: [Title]" --color "C5DEF5"` |
| epic-1 | C5DEF5 | Epic 1: [Title from StoryBreakdown.md] | `gh label create "epic-1" --description "Epic 1: [Title]" --color "C5DEF5"` |
| epic-2 | C5DEF5 | Epic 2: [Title from StoryBreakdown.md] | `gh label create "epic-2" --description "Epic 2: [Title]" --color "C5DEF5"` |
| ... | ... | ... (continue for all epics found) | ... |

### Domain-Specific

**Infer domain labels from PRD.md and project context - examples below, adapt to project**

| Label | Color | Description | Command |
|-------|-------|-------------|---------|
| [domain-1] | 006B75 | [Description based on project] | `gh label create "[domain-1]" --description "[Description]" --color "006B75"` |
| [domain-2] | BFD4F2 | [Description based on project] | `gh label create "[domain-2]" --description "[Description]" --color "BFD4F2"` |

---

## Quick Apply All Labels

```bash
gh label create "story" --description "User story or feature implementation" --color "0E8A16"
gh label create "epic" --description "Large feature spanning multiple stories" --color "5319E7"
gh label create "infra" --description "Infrastructure, build, CI/CD, refactoring" --color "FBCA04"
gh label create "P0" --description "Critical priority - blocks other work" --color "B60205"
gh label create "P1" --description "High priority" --color "D93F0B"
gh label create "P2" --description "Medium priority" --color "FBCA04"
# Epic labels - generate from StoryBreakdown.md
gh label create "epic-0" --description "Epic 0: [Title]" --color "C5DEF5"
gh label create "epic-1" --description "Epic 1: [Title]" --color "C5DEF5"
# ... (continue for all epics)
# Domain labels - infer from project context
gh label create "[domain-1]" --description "[Description]" --color "006B75"
gh label create "[domain-2]" --description "[Description]" --color "BFD4F2"
```

**Note:** Commands skip labels that already exist (no errors).

---

## Usage Criteria

### Issue Types
- `story` - Standard feature work (90% of issues)
- `epic` - Epic-level tracking issues only
- `infra` - Non-feature work (setup, CI/CD, refactoring)

### Priorities
- `P0` - Blocks release or other work (use sparingly)
- `P1` - Important, schedule in current sprint
- `P2` - Nice-to-have, schedule after P0/P1
- No label - Backlog / low priority

### Epic Tracking
- Every story should have exactly ONE epic label
- Epic labels map to specs/StoryBreakdown.md structure

### Domain-Specific
- Apply when relevant (can use multiple)
- Optional labels, add context

---

**Last Updated:** YYYY-MM-DD
**Generated By:** /setup-labels command
```

### Step 4: Present to User

After generating `.github/LABELS.md`, show summary with actual counts from the project:

```
‚úÖ Generated .github/LABELS.md

üìä Summary:
   Total labels proposed: [N]
   - Standard: 3 (story, epic, infra)
   - Priorities: 3 (P0, P1, P2)
   - Epic tracking: [N] (epic-0 to epic-[N-1])
   - Domain-specific: [N] ([list domain labels])

üìÑ File: .github/LABELS.md

Should I create these labels in GitHub? (yes/no)
```

### Step 5: Wait for Approval

- **If "yes":** Execute gh commands (Step 6)
- **If "no":** File remains for manual use
- **If changes requested:** Update and ask again

### Step 6: Execute Commands (Only if Approved)

For each label in the proposal:

```bash
gh label create "label-name" \
  --description "description" \
  --color "hex-color" \
  2>&1 || echo "‚ö†Ô∏è  Label 'label-name' already exists (skipping)"
```

Show progress (example output):

```
üöÄ Creating labels...

‚úÖ Created: story
‚ö†Ô∏è  Already exists: epic (skipping)
‚úÖ Created: infra
‚úÖ Created: P0
‚úÖ Created: epic-0
‚úÖ Created: epic-1
# ... (show all labels being created)

üìä Summary:
   Total labels: [N]
   - Created: [N] new
   - Skipped: [N] existing

‚úÖ Label setup complete!
```

### Step 7: Delta Report

Compare before/after:

```bash
# Get final state
gh label list --json name,color,description
```

Show delta (example output):

```
üìä Delta Report:

**Added ([N] labels):**
- [label-name] ([color])
- [label-name] ([color])
# ... (list all newly created labels)

**Already Existed ([N] labels):**
- [label-name] ([color])
# ... (list all skipped labels)

**Unchanged (GitHub defaults):**
- bug, enhancement, documentation, etc.

Total labels in repo: [N]
```

## Error Handling

### Missing Prerequisites

Check for `gh` CLI:
```bash
if ! command -v gh &> /dev/null; then
    echo "‚ùå GitHub CLI (gh) not found"
    echo "Install: https://cli.github.com/"
    exit 1
fi
```

Check authentication:
```bash
if ! gh auth status &> /dev/null; then
    echo "‚ùå Not authenticated with GitHub"
    echo "Run: gh auth login"
    exit 1
fi
```

### No Specs Found

```
‚ùå specs/StoryBreakdown.md not found

This command requires project specifications to generate labels.
```

## Example: CodeGnosis

**Input:** [specs/StoryBreakdown.md](specs/StoryBreakdown.md)

**Extracted:**
- Epic 0: Environment Setup (Day 1)
- Epic 1: Indexing Pipeline (Days 2-4)
- Epic 2: MCP Server & Demo Features (Days 5-7)
- Epic 3: Client Integration & Packaging (Days 8-10)

**Domain (inferred):**
- Air-gapped deployment (from PRD.md context)
- Dependency management (bundling emphasis)

**Generated Labels:** 12 total (story, epic, infra, P0-P2, epic-0 to epic-3, dependencies, air-gapped)

## When to Run

**First Time:**
- New project setup
- Before creating first issue
- Before using `/compounding-engineering:plan`

**After Epic Changes:**
- Added Epic 4 to StoryBreakdown.md
- Run `/setup-labels` to create epic-4 label

**Manual Alternative:**
- User can copy commands from `.github/LABELS.md`
- Paste into terminal and execute

## Why This Works

**vs Manual Creation:**
- ‚úÖ 30 seconds vs 5 minutes
- ‚úÖ Consistent naming and colors
- ‚úÖ Best practices baked in

**vs Python Scripts:**
- ‚úÖ No regex brittleness
- ‚úÖ Handles any spec format
- ‚úÖ LLM understands context naturally
- ‚úÖ Zero code to maintain

**vs GitHub Actions:**
- ‚úÖ User reviews before applying
- ‚úÖ On-demand, not automatic
- ‚úÖ Works in air-gapped environments

## File Location

**Command:** `~/.claude/commands/setup-labels.md` (global, works for all projects)
**Output:** `.github/LABELS.md` (per-project, version-controlled)

For scaffolding: Copy this file to new project or use globally from `~/.claude/commands/`.
